- Feature Name: `exploit`
- Start Date: 2024-05-11

# Summary
[summary]: #summary

`ctftool` can be used to generate exploit skeletons.

# Motivation
[motivation]: #motivation

Generating exploit skeletons saves time.

# Guide-level explanation
[guide-level-explanation]: #guide-level-explanation

In order to generate an exploit skeleton, do `ctf exploit init` in a challenge directory after adding the challenge
services and binaries.

# Reference-level explanation
[reference-level-explanation]: #reference-level-explanation

`ctf exploit init` first heuristically determines the main challenge binary and the challenge type: either linux
userspace or linux kernel.

For linux userspace challenges, it generates the `pwnit.py` file containing a pwntools-based skeleton. The skeleton
contains the hardcoded challenge binary name, service host and service port. Besides the usual pwntools args, such as
`DEBUG`, the skeleton supports the following ones, which are based on the pwntools' `pwnup.mako`:

* `LOCAL` means that the local challenge binary must be started and exploited. By default, the service is exploited.

* `GDB` means that the local challenge binary must be started under GDB.

For linux kernel challenges, it generates the `pwnit.c` and the `Makefile` files containing a static `musl-gcc`
skeleton. The `Makefile` has the following targets:

* `clipboard` (default): copies a huge command into the clipboard. The command extracts the embedded base64-encoded
  compressed exploit and runs it.

* `fmt`: formats `pwnit.c` with `clang-format`.

# Drawbacks
[drawbacks]: #drawbacks

None.

# Rationale and alternatives
[rationale-and-alternatives]: #rationale-and-alternatives

Over time, I developed a few exploit templates that I look up, copy over and adjust each time. Automating this
mechanical work is a quality-of-life improvement which will save a few minutes for each challenge.

# Prior art
[prior-art]: #prior-art

* https://github.com/io12/pwninit
* `pwn template` command.

# Unresolved questions
[unresolved-questions]: #unresolved-questions

None.

# Future possibilities
[future-possibilities]: #future-possibilities

* Add a shortcut for running exploits against different services.

* Allow having multiple exploits.

* Detect whether a challenge is for a foreign architectures and take this into account when generating a skeleton.

* Add Windows and macOS userspace and kernel skeletons.

* Generate a pwntools-based kernel exploit runner.
